<!--pages/message/message.wxml-->
<view class="container">
  <view class="header">
    <text class="iconfont iconfont icon-liuyan"></text>
    <text class="title">消息中心</text>
  </view>

  <scroll-view class="chat-container" scroll-y="true" scroll-into-view="msg-{{messages.length-1}}" scroll-with-animation="true" style="height: calc(100vh - 110px);">
    <block wx:for="{{messages}}" wx:key="index">
      <view id="msg-{{index}}" class="{{item.is_admin ? 'message-item admin' : 'message-item user'}}">
        <view class="avatar">
          <view class="avatar-circle {{item.is_admin ? 'admin-avatar' : 'user-avatar'}}">
            {{item.is_admin ? '管' : '我'}}
          </view>
        </view>
        <view class="message-content">
          <view class="message-bubble">
            <text class="message-text">{{item.content}}</text>
          </view>
          <view class="message-time">{{item.created_at}}</view>
        </view>
      </view>
    </block>
    <view class="message-placeholder"></view>
  </scroll-view>

  <view class="message-form">
    <textarea class="message-input" placeholder="请输入您的问题或消息内容..." bindinput="onMessageInput" value="{{messageContent}}" auto-focus="{{false}}" confirm-type="send" fixed="true" cursor-spacing="20"></textarea>
    <button class="send-button" bindtap="sendMessage">
      <text class="send-text">发送</text>
    </button>
  </view>
</view>